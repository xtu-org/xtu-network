<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="https://www.xtu.edu.cn/favicon.ico" type="image/x-icon">
    <title>校园网密码RSA加密</title>
    <script src="./security.js"></script>

    <script>
        while (true) {
            const password = prompt('请输入你的校园网密码', "");
            if (!password) continue;

            const encrypted = encryptedPassword(password.trim());
            alert(`加密后的密码为：${encrypted}`);
            console.info(`加密后的密码为：${encrypted}`);
            break;
        }

        function encryptedPassword(password) {
            const passwordEncode = password.split("").reverse().join("");
            const publicKeyExponent = "10001";
            const publicKeyModulus = "94dd2a8675fb779e6b9f7103698634cd400f27a154afa67af6166a43fc26417222a79506d34cacc7641946abda1785b7acf9910ad6a0978c91ec84d40b71d2891379af19ffb333e7517e390bd26ac312fe940c340466b4a5d4af1d65c3b5944078f96a1a51a5a53e4bc302818b7c9f63c4a1b07bd7d874cef1c3d4b2f5eb7871";
            RSAUtils.setMaxDigits(400);
            const key = new RSAUtils.getKeyPair(publicKeyExponent, "", publicKeyModulus);
            const passwordEncry = RSAUtils.encryptedString(key, passwordEncode);
            return passwordEncry;
        }
    </script>
</head>

<body>

</body>

</html>